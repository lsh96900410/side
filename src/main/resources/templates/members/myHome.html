<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Prepare Developer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- BootStrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <!-- BootStrap-->

    <link rel="stylesheet" type="text/css" href="/css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/line-awesome.css">
    <link rel="stylesheet" type="text/css" href="css/line-awesome-font-awesome.min.css">
    <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/lib/slick/slick.css">
    <link rel="stylesheet" type="text/css" href="/lib/slick/slick-theme.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/responsive.css">
</head>
<script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.8/handlebars.min.js"></script>
<body style="font-family: AppleSDGothicNeoM00">
<div class="wrapper">
    <header>
        <div class="container">
            <div class="header-data">
                <div class="logo">
                    <a href="/todo" title=""><img src="/images/logo.png" alt=""></a>
                </div><!--logo end-->
<!--                <div class="search-bar">-->
<!--                    <form>-->
<!--                        <input type="text" name="search" placeholder="Search...">-->
<!--                        <button type="submit"><i class="la la-search"></i></button>-->
<!--                    </form>-->
<!--                </div>&lt;!&ndash;search-bar end&ndash;&gt;-->
                <nav>
                    <ul>
                        <li>
                            <a href="#" title="" class="not-box-open"
                               th:onclick="alarm()">
                                <span><img src="/images/icon7.png" alt="" ></span>
                                알림
                            </a>
                            <div class="notification-box noti" id="notification">
<!--                                <div class="nt-title">-->
<!--                                    <h4>Setting</h4>-->
<!--                                    <a href="#" title="">Clear all</a>-->
<!--                                </div>-->

                                <div class="nott-list" id="alarm-Template">
                                    <div class="notfication-details">
                                        <div class="noty-user-img">
                                            <img src="/images/resources/ny-img1.png" alt="">
                                        </div>
                                        <div class="notification-info">
                                            <h3><a href="#" title="">Jassica William</a> Comment on your project.</h3>
                                        </div><!--notification-info -->
                                    </div>
                                </div>

                                <script id="CSR-alarm"  type="text/x-handlebars-template">

                                {{#each data}}
                                <div class="nott-list">
                                    <div class="notfication-details">
                                        <div class="noty-user-img">
                                            {{#if image}}
                                            <img src="/memberProfileUpload/{{image}}" alt="">
                                            {{else}}
                                            <img src="/images/resources/ny-img1.png" alt="">
                                            {{/if}}
                                        </div>
                                        <div class="notification-info">
                                            <h3><a href="#" title="">{{memberName}}</a>{{message}}</h3>
                                        </div><!--notification-info -->
                                    </div>
                                </div><!--nott-list end-->
                                    {{/each}}
                                </script>

                            </div><!--notification-box end-->
                        </li>
                    </ul>
                </nav><!--nav end-->
<!--                <div class="menu-btn">-->
<!--                    <a href="#" title=""><i class="fa fa-bars"></i></a>-->
<!--                </div>&lt;!&ndash;menu-btn end&ndash;&gt;-->
<!--                <div class="user-account">-->
<!--                    <div class="user-info">-->
<!--                        <img src="/images/resources/user.png" alt="">-->
<!--                        <a href="#" title="">John</a>-->
<!--                        <i class="la la-sort-down"></i>-->
<!--                    </div>-->
                    <div class="login_register">
                        <ul>
                        <li><a href="/members/logout" title="" >Logout</a></li>
                        </ul>
                    </div>
<!--                </div>-->
            </div><!--header-data end-->
        </div>
    </header><!--header end-->

    <main>
        <div class="main-section">
            <div class="container">
                <div class="main-section-data">
                    <div class="row">
                        <div class="col-lg-3">
                            <div class="main-left-sidebar">
                                <div class="user_profile">
                                    <div class="user-pro-img" style="margin-top: 20px;">
                                        <img src="/images/resources/ny-img1.png" alt="" th:if="${feedData.uploadLocation ==null}">
                                        <img alt="" th:src="|/memberProfileUpload/${feedData.uploadLocation}|"  th:if="${feedData.uploadLocation !=null}"
                                             style="width: 200px; height: 200px; object-fit: cover;">
<!--                                        -->
                                        <div class="add-dp" id="OpenImgUpload" th:if="${#authentication.principal.member.id == feedData.memberId}">
                                            <input type="file" id="file">
                                            <label for="file" th:onclick="uploadFile()"><i class="fas fa-camera" ></i> </label>
                                        </div>
                                    </div><!--user-pro-img end-->
                                    <!-- Todo : 회원 이미지 넣기 -->
                                    <div class="user_pro_status">
                                        <ul class="flw-hr">
                                            <li><a title="" class="flww" th:if="${feedData.follow == false && #authentication.principal.member.id != feedData.memberId}"
                                                   th:onclick="'follow(' + ${feedData.memberId} +','+${#authentication.principal.member.id}+')'"> 팔로우</a></li>
                                            <li><a title="" class="flww" th:if="${feedData.follow == true && #authentication.principal.member.id != feedData.memberId}"
                                                    th:onclick="'unFollow(' + ${feedData.memberId} +','+${#authentication.principal.member.id}+')'"> 팔로우 취소</a></li>
                                            <!-- 아이콘 :  <i class="la la-plus"></i>-->
                                        </ul>

                                        <ul class="flw-status">
                                            <li>
                                                <span>Following</span>
                                                <b th:text="${feedData.totalFollowingCount}">34</b>
                                            </li>
                                            <li>
                                                <span>Followers</span>
                                                <b th:text="${feedData.totalFollowerCount}">155</b>
                                            </li>
                                        </ul>
                                    </div><!--user_pro_status end-->

                                </div><!--user_profile end-->
                                <div class="suggestions full-width">
                                    <div class="sd-title">
                                        <h3> 가장 많이 찾은 회원 </h3>
                                        <i class="la la-ellipsis-v"></i>
                                    </div>
                                    <div class="suggestions-list" th:each="data : ${feedData.topMembers}" th:onclick="'viewFeed('+${data.memberId}+')'" style="cursor: pointer">
                                        <div class="suggestion-usd" >
                                            <img th:if="${data.profileImage==null}" src="/images/resources/s1.png" alt="" >
                                            <img alt="" th:if="${data.profileImage !=null}" th:src="|/memberProfileUpload/${data.profileImage}|"
                                                 style="width: 40px; height: 40px; object-fit: cover;">
                                            <div class="sgt-text">
                                                <h4 th:text="${data.name}">Jessica William</h4>
                                                <span th:text="${data.developerPosition} +' 개발자 '">Graphic Designer</span>
                                            </div>
                                            <span><i class="la la-plus" ></i></span>
                                        </div>
                                    </div>
                                </div>



                            </div>
                            <!--main-left-sidebar end-->
                        </div>
                        <!-- 개인 회원 프로필 내용 -->
                        <div class="col-lg-6">
                            <div class="main-ws-sec">
                                <div class="user-tab-sec">
                                    <h3 th:text="'안녕하세요,'+ ${feedData.name}+ ' 님'">John Doe</h3>
                                    <div class="star-descp">
                                        <span th:text=" ${feedData.developerPosition}+' 직군 취업을 위해 화이팅입니다.'">Graphic Designer at Self Employed</span>

                                    </div><!--star-descp end-->

                                    <div class="tab-feed">
                                        <ul th:if="${#authentication.principal.member.id == feedData.memberId}">
                                            <li data-tab="feed-dd" class="active">
                                                <a href="#" title="">
                                                    <img src="/images/ic1.png" alt="">
                                                    <span> 목표 </span>
                                                </a>
                                            </li>
<!--                                            <li data-tab="info-dd">-->
<!--                                                <a href="#" title="">-->
<!--                                                    <img src="/images/ic2.png" alt="">-->
<!--                                                    <span> 내 정보</span>-->
<!--                                                </a>-->
<!--                                            </li>-->
                                        </ul>
                                    </div><!-- tab-feed end-->
                                </div><!--user-tab-sec end-->

                                <div class="product-feed-tab current" id="feed-dd" >
                                    <div class="posts-section" th:if="${feedData!=null}">
                                        <div class="post-bar" style="border: 2px solid #ccc;
        border-radius: 10px;
        padding: 20px;">
                                            <form action="/todo" method="post" th:if="${#authentication.principal.member.id == feedData.memberId}">
                                                <input type="text" name="title" placeholder="이번 목표는 무엇인가요 ? " style="width: calc(100% - 12px); /* 너비 조정 가능 */
        margin-bottom: 10px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;"><br>
                                                <input type="text" name="keyword" placeholder="목표와 관련된 키워드를 입력해주세요. " style="width: calc(100% - 12px); /* 너비 조정 가능 */
        margin-bottom: 10px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;">
                                                <button type="submit" style="padding: 10px 20px;
        background-color: tomato;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;"> 목표 설정하기</button>
                                            </form>
                                        </div>

                                        <div class="post-bar" th:each=" data : ${feedData.todos}" th:onclick="'viewDetail(' + ${data.id} + ')'">
                                                <div class="post_topbar" >

                                                    <div class="ed-opts" >
                                                        <a href="#" title="" class="ed-opts-open"><i class="la la-ellipsis-v"></i></a>
                                                        <ul class="ed-options" th:text="${data.id}">
                                                            <li><a href="#" title="">Edit Post</a></li>
                                                            <li><a href="#" title="">Unsaved</a></li>
                                                            <li><a href="#" title="">Unbid</a></li>
                                                            <li><a href="#" title="">Close</a></li>
                                                            <li><a href="#" title="">Hide</a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="epi-sec">

                                                </div>
                                                <div class="job_descp">
                                                <!-- Todo리스트 타이틀 제목 보여주기    -->

                                                <!-- Todo리스트 키워드 보여주기    -->
                                                    <ul class="skill-tags"  style="list-style: none; padding: 0; margin: 0;">
                                                        <li style="display: flex; justify-content: space-between;"> <span th:text="${data.title}" style="font: -apple-system-headline">프로젝트 진행하기 ! </span> <a href="#" th:text="${data.keyword}">HTML</a></li>
                                                    </ul>
                                                </div>
                                                <!--<span style="padding-left: 40px;"-->
                                                <div class="job-status-bar">
                                                    <ul class="like-com">
                                                        <li>
                                                            <a href="#" class="active" ><i class="fa heart heart-clicked fa-heart"></i> Like</a>
                                                            <img src="/images/liked-img.png" alt="">
                                                            <span th:text="${data.likeCount}">25</span>
                                                        </li>
                                                        <!--														<li><a href="#" class="com"><i class="fas fa-comment-alt"></i> Comments 15</a></li>-->
                                                    </ul>
                                                    <a href="#" ><i class="fas fa-eye"></i><span th:text="'Views '+${data.viewCount}">Views 50</span></a>
                                                </div>
<!--                                            </a>-->
                                        </div><!--post-bar end-->

<!--                                        <div class="process-comm">-->
<!--                                            <div class="spinner">-->
<!--                                                <div class="bounce1"></div>-->
<!--                                                <div class="bounce2"></div>-->
<!--                                                <div class="bounce3"></div>-->
<!--                                            </div>-->
<!--                                        </div>&lt;!&ndash;process-comm end&ndash;&gt;-->
                                    </div><!--posts-section end-->
                                </div>
                                <!-- info 클릭 부분 -->
<!--                                <div class="product-feed-tab" id="info-dd">-->
<!--                                    <div class="user-profile-ov">-->
<!--                                        <h3>여긴 어데여?</h3>-->
<!--                                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tempor aliquam felis, nec condimentum ipsum commodo id. Vivamus sit amet augue nec urna efficitur tincidunt. Vivamus consectetur aliquam lectus commodo viverra. Nunc eu augue nec arcu efficitur faucibus. Aliquam accumsan ac magna convallis bibendum. Quisque laoreet augue eget augue fermentum scelerisque. Vivamus dignissim mollis est dictum blandit. Nam porta auctor neque sed congue. Nullam rutrum eget ex at maximus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eget vestibulum lorem.</p>-->
<!--                                    </div>&lt;!&ndash;user-profile-ov end&ndash;&gt;-->
<!--                                    <div class="user-profile-ov st2">-->
<!--                                        <h3>Experience</h3>-->
<!--                                        <h4>Web designer</h4>-->
<!--                                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tempor aliquam felis, nec condimentum ipsum commodo id. Vivamus sit amet augue nec urna efficitur tincidunt. Vivamus consectetur aliquam lectus commodo viverra. </p>-->
<!--                                        <h4>UI / UX Designer</h4>-->
<!--                                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tempor aliquam felis, nec condimentum ipsum commodo id.</p>-->
<!--                                        <h4>PHP developer</h4>-->
<!--                                        <p class="no-margin">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tempor aliquam felis, nec condimentum ipsum commodo id. Vivamus sit amet augue nec urna efficitur tincidunt. Vivamus consectetur aliquam lectus commodo viverra. </p>-->
<!--                                    </div>&lt;!&ndash;user-profile-ov end&ndash;&gt;-->
<!--                                    <div class="user-profile-ov">-->
<!--                                        <h3>Education</h3>-->
<!--                                        <h4>Master of Computer Science</h4>-->
<!--                                        <span>2015 - 2018</span>-->
<!--                                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tempor aliquam felis, nec condimentum ipsum commodo id. Vivamus sit amet augue nec urna efficitur tincidunt. Vivamus consectetur aliquam lectus commodo viverra. </p>-->
<!--                                    </div>&lt;!&ndash;user-profile-ov end&ndash;&gt;-->
<!--                                  -->
<!--                                    <div class="user-profile-ov">-->
<!--                                        <h3>Skills</h3>-->
<!--                                        <ul>-->
<!--                                            <li><a href="#" title="">HTML</a></li>-->
<!--                                            <li><a href="#" title="">PHP</a></li>-->
<!--                                            <li><a href="#" title="">CSS</a></li>-->
<!--                                            <li><a href="#" title="">Javascript</a></li>-->
<!--                                            <li><a href="#" title="">Wordpress</a></li>-->
<!--                                            <li><a href="#" title="">Photoshop</a></li>-->
<!--                                            <li><a href="#" title="">Illustrator</a></li>-->
<!--                                            <li><a href="#" title="">Corel Draw</a></li>-->
<!--                                        </ul>-->
<!--                                    </div>&lt;!&ndash;user-profile-ov end&ndash;&gt;-->
<!--                                </div>&lt;!&ndash;product-feed-tab end&ndash;&gt;-->
                            </div><!--main-ws-sec end-->
                        </div>
                        <div class="col-lg-3">
                            <div class="right-sidebar">

                                <div class="suggestions full-width">
                                    <div class="sd-title">
                                        <h3>직군이 같아요 ! </h3>
                                        <i class="la la-ellipsis-v"></i>
                                    </div>
                                    <div class="suggestions-list" th:each="data : ${feedData.elseMembers}" th:onclick="'viewFeed('+${data.id}+')'" style="cursor: pointer">
                                        <div class="suggestion-usd" >
                                            <img th:if="${data.uploadFile==null}" src="/images/resources/s1.png" alt="" >
                                            <img alt="" th:if="${data.uploadFile !=null}" th:src="|/memberProfileUpload/${data.uploadFile}|"
                                                 style="width: 40px; height: 40px; object-fit: cover;">
                                            <div class="sgt-text">
                                                <h4 th:text="${data.otherName}">Jessica William</h4>
                                                <span th:text="${data.developerPosition} +' 개발자 '">Graphic Designer</span>
                                            </div>
                                            <span><i class="la la-plus" ></i></span>
                                        </div>
                                    </div>
                                </div>
<!--                                <div class="suggestions full-width">-->
<!--                                    <div class="sd-title">-->
<!--                                        <h3>키워드가 동일해요 ! </h3>-->
<!--                                        <i class="la la-ellipsis-v"></i>-->
<!--                                    </div>-->
<!--                                    <div class="suggestions-list" th:each="data : ${feedData.elseTodos}" th:onclick="'viewDetail('+${data.todoId}+')'" style="cursor: pointer">-->
<!--                                        <div class="suggestion-usd">-->
<!--                                            <img th:if="${data.uploadFile==null}" src="/images/resources/s1.png" alt="">-->
<!--                                            <img alt="" th:if="${data.uploadFile !=null}" th:src="|/memberProfileUpload/${data.uploadFile}|"-->
<!--                                                 style="width: 40px; height: 40px; object-fit: cover;">-->
<!--                                            <div class="sgt-text">-->
<!--                                                <h4 th:text="${data.memberName}">Jessica William</h4>-->
<!--                                                <span th:text="${data.todoTitle}">Graphic Designer</span>-->
<!--                                            </div>-->
<!--                                            <span><i class="la la-plus"></i></span>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
                            </div><!--right-sidebar end-->
                        </div>
                    </div>
                </div><!-- main-section-data end-->
            </div>
        </div>
    </main>

<!--    <div class="overview-box" id="create-portfolio">-->
<!--        <div class="overview-edit">-->
<!--            <h3>Create Portfolio</h3>-->
<!--            <form>-->
<!--                <input type="text" name="pf-name" placeholder="Portfolio Name">-->
<!--                <div class="file-submit">-->
<!--                    <input type="file" name="file">-->
<!--                </div>-->
<!--                <div class="pf-img">-->
<!--                    <img src="/images/resources/np.png" alt="">-->
<!--                </div>-->
<!--                <input type="text" name="website-url" placeholder="htp://www.example.com">-->
<!--                <button type="submit" class="save">Save</button>-->
<!--                <button type="submit" class="cancel">Cancel</button>-->
<!--            </form>-->
<!--            <a href="#" title="" class="close-box"><i class="la la-close"></i></a>-->
<!--        </div>&lt;!&ndash;overview-edit end&ndash;&gt;-->
<!--    </div>&lt;!&ndash;overview-box end&ndash;&gt;-->



</div><!--theme-layout end-->


<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/popper.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/slick/slick.min.js"></script>
<script type="text/javascript" src="/js/script.js"></script>>
<script>

    function uploadFile() {
        console.log('uploadFile 실행 중 !! ')
        let fileInput = document.getElementById('file');

        fileInput.click(); // 파일 선택을 위해 파일 입력을 클릭

        fileInput.onchange = function () {
            let file = fileInput.files[0]; // 선택한 파일 가져오기

            let formData = new FormData();
            formData.append('file', file);

            console.log(' formData 는 ' + formData)
            // AJAX 요청으로 파일 업로드
            $.ajax({
                url: '/members/upload', // 서버 업로드 엔드포인트
                type: 'POST', // POST 요청
                data: formData, // 폼 데이터 전송
                processData: false, // jQuery에서 데이터 처리하지 않음
                contentType: false, // 내용 유형을 설정하지 않음
                success: function (response) {
                    console.log('File uploaded:', response); // 업로드 성공 메시지
                    location.reload()
                },
                error: function (error) {
                    console.error('Error uploading file:', error); // 업로드 실패 메시지
                }
            });
        };
    }

    function follow(feedMemberId,loginMemberId){
        console.log('follow 함수 실행 중 ! ')

        let followRequestData = {
            followerId : loginMemberId,
            followingId : feedMemberId
        }

        console.log(followRequestData)

        $.ajax({
            url:"/follow",
            method: "post",
            contentType: 'application/json',
            data : JSON.stringify(followRequestData),
            success : function(){
                console.log('팔로우 성공 완료 함수 로직 실행 ')
                location.reload();

            }
        }

        )

    }

    function alarm(){
        console.log(' 알람 함수 실행중')

        $.ajax({
            url:"/alarm",
            method:"get",
            success : function (response){
                console.log('아작스 성공 함수')
                console.log(response)

                let template = Handlebars.compile($('#CSR-alarm').html());
                let mixed = template(response);
                console.log(mixed)
                $('#alarm-Template').html(mixed);

            }
        })
    }

    function unFollow(feedMemberId,loginMemberId) {
        console.log('unfollow 함수 실행 중 ! ')

        let unFollowRequestData = {
            followerId: loginMemberId,
            followingId: feedMemberId
        }

        console.log(unFollowRequestData)

        $.ajax({
            url: "/follow",
            method: "delete",
            contentType: 'application/json',
            data: JSON.stringify(unFollowRequestData),
            success: function () {
                location.reload();

            }
        })

        function search() {
            let searchData =
                {
                    searchType: $("#type").val(),
                    searchText: $("#searchText").val(),
                    role: $("#role").val(),
                    provider: $("#provider").val()
                }

            console.log('search Onclick !!!!!' + JSON.stringify(searchData));
            $.ajax({
                url: "/members/search",
                method: "POST",
                data: JSON.stringify(searchData),
                dataType: "json",
                contentType: "application/json"
            }).then((response) => {
                    let template = Handlebars.compile($('#CSR-search-Member').html());
                    let mixed = template(response);
                    $('#table-Template').html(mixed)
                }
            );
        }




        async function like() {
            let response = await fetch
        }

        function viewFeed(memberId) {
            window.location.href = '/members/' + memberId;
        }


        function viewDetail(todoId) {
            window.location.href = '/todo/' + todoId;
        };
    }
</script>

</body>
</html>